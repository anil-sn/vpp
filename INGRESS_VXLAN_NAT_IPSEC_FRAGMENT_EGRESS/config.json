{
  "default_mode": "gcp",
  "modes": {
    "gcp": {
      "networks": [
        {
          "name": "external-ingress",
          "subnet": "172.20.0.0/24",
          "gateway": "172.20.0.1",
          "description": "External network for Ingress"
        },
        {
          "name": "ingress-vxlan",
          "subnet": "172.20.1.0/24",
          "gateway": "172.20.1.1",
          "description": "Ingress → VXLAN"
        },
        {
          "name": "vxlan-nat",
          "subnet": "172.20.2.0/24",
          "gateway": "172.20.2.1",
          "description": "VXLAN → NAT"
        },
        {
          "name": "nat-ipsec",
          "subnet": "172.20.3.0/24",
          "gateway": "172.20.3.1",
          "description": "NAT → IPsec"
        },
        {
          "name": "ipsec-fragment",
          "subnet": "172.20.4.0/24",
          "gateway": "172.20.4.1",
          "description": "IPsec → Fragment"
        },
        {
          "name": "fragment-gcp",
          "subnet": "172.20.5.0/24",
          "gateway": "172.20.5.1",
          "description": "Fragment → GCP"
        }
      ],
      "containers": [
        {
          "name": "chain-ingress",
          "description": "VXLAN packet reception",
          "config": "ingress-config.sh",
          "dockerfile": "src/containers/ingress/Dockerfile.ingress",
          "networks": {
            "external-ingress": "172.20.0.10",
            "ingress-vxlan": "172.20.1.10"
          }
        },
        {
          "name": "chain-vxlan",
          "description": "VXLAN decapsulation",
          "config": "vxlan-config.sh",
          "dockerfile": "src/containers/vxlan/Dockerfile.vxlan",
          "networks": {
            "ingress-vxlan": "172.20.1.20",
            "vxlan-nat": "172.20.2.10"
          }
        },
        {
          "name": "chain-nat",
          "description": "NAT44 translation",
          "config": "nat-config.sh",
          "dockerfile": "src/containers/Dockerfile.base",
          "networks": {
            "vxlan-nat": "172.20.2.20",
            "nat-ipsec": "172.20.3.10"
          }
        },
        {
          "name": "chain-ipsec",
          "description": "IPsec encryption",
          "config": "ipsec-config.sh",
          "dockerfile": "src/containers/ipsec/Dockerfile.ipsec",
          "networks": {
            "nat-ipsec": "172.20.3.20",
            "ipsec-fragment": "172.20.4.10"
          }
        },
        {
          "name": "chain-fragment",
          "description": "IP fragmentation",
          "config": "fragment-config.sh",
          "dockerfile": "src/containers/fragment/Dockerfile.fragment",
          "networks": {
            "ipsec-fragment": "172.20.4.20",
            "fragment-gcp": "172.20.5.10"
          }
        },
        {
          "name": "chain-gcp",
          "description": "GCP destination endpoint",
          "config": "gcp-config.sh",
          "dockerfile": "src/containers/Dockerfile.base",
          "networks": {
            "fragment-gcp": "172.20.5.20"
          }
        }
      ],
      "connectivity_tests": [
        {
          "from": "chain-ingress",
          "to": "172.20.1.20",
          "description": "Ingress → VXLAN"
        },
        {
          "from": "chain-vxlan",
          "to": "172.20.2.20",
          "description": "VXLAN → NAT"
        },
        {
          "from": "chain-nat",
          "to": "172.20.3.20",
          "description": "NAT → IPsec"
        },
        {
          "from": "chain-ipsec",
          "to": "172.20.4.20",
          "description": "IPsec → Fragment"
        },
        {
          "from": "chain-fragment",
          "to": "172.20.5.20",
          "description": "Fragment → GCP"
        }
      ],
      "traffic_config": {
        "bridge_ip": "172.20.0.1",
        "vxlan_port": 4789,
        "vxlan_vni": 100,
        "inner_src_ip": "10.10.10.5",
        "inner_dst_ip": "10.10.10.10",
        "inner_dst_port": 2055,
        "packet_count": 10,
        "packet_size": 1200,
        "test_duration": 10
      }
    },
    "aws": {
      "networks": [
        {
          "name": "underlay",
          "subnet": "172.31.0.0/20",
          "gateway": "172.31.0.1",
          "description": "Main underlay network for AWS"
        },
        {
          "name": "chain-1-2",
          "subnet": "10.0.1.0/24",
          "gateway": "10.0.1.1",
          "description": "Ingress → VXLAN for AWS"
        },
        {
          "name": "chain-2-3",
          "subnet": "10.0.2.0/24",
          "gateway": "10.0.2.1",
          "description": "VXLAN → NAT for AWS"
        },
        {
          "name": "chain-3-4",
          "subnet": "10.0.3.0/24",
          "gateway": "10.0.3.1",
          "description": "NAT → IPsec for AWS"
        },
        {
          "name": "chain-4-5",
          "subnet": "10.0.4.0/24",
          "gateway": "10.0.4.1",
          "description": "IPsec → Fragment for AWS"
        }
      ],
      "containers": [
        {
          "name": "chain-ingress",
          "description": "VXLAN packet reception (AWS)",
          "config": "ingress-config.sh",
          "dockerfile": "src/containers/ingress/Dockerfile.ingress",
          "networks": {
            "underlay": "172.31.1.10",
            "chain-1-2": "10.0.1.1"
          }
        },
        {
          "name": "chain-vxlan",
          "description": "VXLAN decapsulation (AWS)",
          "config": "vxlan-config.sh",
          "dockerfile": "src/containers/vxlan/Dockerfile.vxlan",
          "networks": {
            "chain-1-2": "10.0.1.2",
            "chain-2-3": "10.0.2.1"
          }
        },
        {
          "name": "chain-nat",
          "description": "NAT44 translation (AWS)",
          "config": "nat-config.sh",
          "dockerfile": "src/containers/Dockerfile.base",
          "networks": {
            "chain-2-3": "10.0.2.2",
            "chain-3-4": "10.0.3.1"
          }
        },
        {
          "name": "chain-ipsec",
          "description": "IPsec encryption (AWS)",
          "config": "ipsec-config.sh",
          "dockerfile": "src/containers/ipsec/Dockerfile.ipsec",
          "networks": {
            "chain-3-4": "10.0.3.2",
            "chain-4-5": "10.0.4.1"
          }
        },
        {
          "name": "chain-fragment",
          "description": "IP fragmentation (AWS)",
          "config": "fragment-config.sh",
          "dockerfile": "src/containers/fragment/Dockerfile.fragment",
          "networks": {
            "chain-4-5": "10.0.4.2",
            "underlay": "172.31.1.20"
          }
        },
        {
          "name": "chain-gcp",
          "description": "Destination endpoint (AWS)",
          "config": "gcp-config.sh",
          "dockerfile": "src/containers/Dockerfile.base",
          "networks": {
            "underlay": "172.31.1.30"
          }
        }
      ],
      "connectivity_tests": [
        {
          "from": "chain-ingress",
          "to": "10.0.1.2",
          "description": "Ingress → VXLAN (AWS)"
        },
        {
          "from": "chain-vxlan",
          "to": "10.0.2.2",
          "description": "VXLAN → NAT (AWS)"
        },
        {
          "from": "chain-nat",
          "to": "10.0.3.2",
          "description": "NAT → IPsec (AWS)"
        },
        {
          "from": "chain-ipsec",
          "to": "10.0.4.2",
          "description": "IPsec → Fragment (AWS)"
        },
        {
          "from": "chain-fragment",
          "to": "172.31.1.30",
          "description": "Fragment → GCP (AWS)"
        }
      ],
      "traffic_config": {
        "bridge_ip": "172.31.0.1",
        "vxlan_port": 4789,
        "vxlan_vni": 100,
        "inner_src_ip": "10.0.10.5",
        "inner_dst_ip": "10.0.10.10",
        "inner_dst_port": 2055,
        "packet_count": 10,
        "packet_size": 1200,
        "test_duration": 10
      }
    }
  }
}
