// =========================================================================
// VPP BNG Lab - Kea DHCPv4 Server Configuration
//
// This file configures the Kea server to handle IPv4 address assignment
// for subscribers connecting to the BNG.
// =========================================================================
{
"Dhcp4": {
    // Kea will listen on all available interfaces.
    // In our setup, VPP acts as a relay, so Kea will receive all requests
    // as unicast packets on its loopback interface (127.0.0.1).
    "interfaces-config": {
        "interfaces": [ "*" ]
    },

    // Use a simple in-memory lease database.
    // 'persist: false' means leases are not saved to disk on shutdown,
    // ensuring a clean state every time the lab starts.
    "lease-database": {
        "type": "memfile",
        "persist": false
    },

    // Standard DHCP lease timers.
    "valid-lifetime": 4000,
    "renew-timer": 1000,
    "rebind-timer": 2000,

    // Define the address pools for each of the 4 VLANs.
    // The BNG (VPP) will add a Relay Agent Information Option (Option 82)
    // to each DHCP request, telling Kea which subnet the request came from.
    "subnet4": [
        {
            "id": 101, // Corresponds to VLAN 101
            "subnet": "192.101.1.0/24",
            "pools": [ { "pool": "192.101.1.10 - 192.101.1.250" } ],
            "option-data": [
                {
                    "name": "routers",
                    "data": "192.101.1.1" // The BNG's gateway IP on this VLAN
                }
            ]
        },
        {
            "id": 102, // Corresponds to VLAN 102
            "subnet": "192.102.1.0/24",
            "pools": [ { "pool": "192.102.1.10 - 192.102.1.250" } ],
            "option-data": [
                { "name": "routers", "data": "192.102.1.1" }
            ]
        },
        {
            "id": 103, // Corresponds to VLAN 103
            "subnet": "192.103.1.0/24",
            "pools": [ { "pool": "192.103.1.10 - 192.103.1.250" } ],
            "option-data": [
                { "name": "routers", "data": "192.103.1.1" }
            ]
        },
        {
            "id": 104, // Corresponds to VLAN 104
            "subnet": "192.104.1.0/24",
            "pools": [ { "pool": "192.104.1.10 - 192.104.1.250" } ],
            "option-data": [
                { "name": "routers", "data": "192.104.1.1" }
            ]
        }
    ]
}
}