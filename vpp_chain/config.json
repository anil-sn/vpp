{
  "default_mode": "aws_production",
  "description": "AWS production configuration for traffic mirror processing - conflict-free IPs",
  "modes": {
    "aws_production": {
      "description": "AWS Mirror Target processing for GCP forwarding",
      "networks": [
        {
          "name": "aws-mirror-ingress",
          "subnet": "192.168.100.0/24",
          "gateway": "192.168.100.1",
          "description": "AWS Traffic Mirror VXLAN ingress",
          "mtu": 9000
        },
        {
          "name": "aws-processing-internal",
          "subnet": "192.168.101.0/24",
          "gateway": "192.168.101.1",
          "description": "Internal processing network",
          "mtu": 9000
        },
        {
          "name": "aws-gcp-transit",
          "subnet": "192.168.102.0/24",
          "gateway": "192.168.102.1",
          "description": "AWS to GCP transit network"
        }
      ],
      "containers": {
        "vxlan-processor": {
          "description": "VXLAN decapsulation and L2 bridging (AWS production)",
          "dockerfile": "src/containers/Dockerfile.vxlan",
          "config_script": "src/containers/vxlan-config.sh",
          "interfaces": [
            {
              "name": "eth0",
              "network": "aws-mirror-ingress",
              "ip": {
                "address": "192.168.100.10",
                "mask": 24
              }
            },
            {
              "name": "eth1",
              "network": "aws-processing-internal",
              "ip": {
                "address": "192.168.101.10",
                "mask": 24
              }
            }
          ],
          "vxlan_tunnel": {
            "src": "192.168.100.10",
            "dst": "192.168.100.1",
            "vni": 100,
            "decap_next": "l2"
          },
          "routes": [
            {
              "to": "10.10.10.0/24",
              "via": "192.168.101.20",
              "interface": "eth1"
            },
            {
              "to": "192.168.102.0/24",
              "via": "192.168.101.20",
              "interface": "eth1"
            }
          ],
          "bvi": {
            "ip": "192.168.201.1/24"
          }
        },
        "security-processor": {
          "description": "NAT44 + IPsec encryption for AWS-GCP transit",
          "dockerfile": "src/containers/Dockerfile.security",
          "config_script": "src/containers/security-config.sh",
          "interfaces": [
            {
              "name": "eth0",
              "network": "aws-processing-internal",
              "ip": {
                "address": "192.168.101.20",
                "mask": 24
              }
            },
            {
              "name": "eth1",
              "network": "aws-gcp-transit",
              "ip": {
                "address": "192.168.102.10",
                "mask": 24
              },
              "mtu": 1400
            }
          ],
          "nat44": {
            "sessions": 4096,
            "static_mapping": {
              "local_ip": "10.10.10.10",
              "local_port": 2055,
              "external_ip": "192.168.102.10",
              "external_port": 2055
            },
            "inside_interface": "eth0",
            "outside_interface": "eth1"
          },
          "ipsec": {
            "sa_in": {
              "id": 2000,
              "spi": 2000,
              "crypto_alg": "aes-gcm-128",
              "crypto_key": "4a506a794f574265564551694d653768"
            },
            "sa_out": {
              "id": 1000,
              "spi": 1000,
              "crypto_alg": "aes-gcm-128",
              "crypto_key": "4a506a794f574265564551694d653768"
            },
            "tunnel": {
              "src": "192.168.101.20",
              "dst": "34.134.82.101",
              "local_ip": "10.100.100.1/30",
              "remote_ip": "10.100.100.2/30"
            }
          },
          "fragmentation": {
            "mtu": 1400,
            "enable": true
          },
          "routes": [
            {
              "to": "34.134.82.101/32",
              "via": "192.168.102.1",
              "interface": "eth1"
            },
            {
              "to": "10.10.10.0/24",
              "via": "ipip0"
            }
          ]
        },
        "destination": {
          "description": "AWS local destination for processed traffic",
          "dockerfile": "src/containers/Dockerfile.destination",
          "config_script": "src/containers/destination-config.sh",
          "interfaces": [
            {
              "name": "eth0",
              "network": "aws-gcp-transit",
              "ip": {
                "address": "192.168.102.20",
                "mask": 24
              }
            }
          ],
          "tap_interface": {
            "id": 0,
            "name": "vpp-tap0",
            "ip": "10.0.3.1/24",
            "linux_ip": "10.0.3.2/24",
            "pcap_file": "/tmp/aws-processed.pcap",
            "rx_mode": "interrupt"
          },
          "ipsec": {
            "sa_in": {
              "id": 1000,
              "spi": 1000,
              "crypto_alg": "aes-gcm-128",
              "crypto_key": "4a506a794f574265564551694d653768"
            },
            "tunnel": {
              "src": "192.168.102.20",
              "dst": "192.168.101.20",
              "local_ip": "10.100.100.2/30"
            }
          },
          "routes": [
            {
              "to": "0.0.0.0/0",
              "via": "192.168.102.1"
            },
            {
              "to": "10.0.3.0/24",
              "via": "tap0"
            },
            {
              "to": "10.100.100.0/30",
              "via": "ipip0"
            }
          ]
        }
      },
      "connectivity_tests": [
        {
          "from": "vxlan-processor",
          "to": "192.168.101.20",
          "description": "VXLAN → Security Processor"
        },
        {
          "from": "security-processor",
          "to": "192.168.102.20",
          "description": "Security Processor → Destination"
        }
      ],
      "traffic_config": {
        "vxlan_port": 4789,
        "vxlan_vni": 100,
        "inner_src_ip": "10.10.10.5",
        "inner_dst_ip": "10.10.10.10",
        "inner_dst_port": 2055,
        "packet_count": 100,
        "packet_size": 1400,
        "test_duration": 30,
        "expected_transformations": [
          "VXLAN decapsulation (vxlan-processor)",
          "NAT44 translation (security-processor)",
          "IPsec encryption (security-processor)",
          "IP fragmentation (security-processor)"
        ]
      },
      "testing_features": {
        "df_bit_testing": {
          "enabled": true,
          "test_packet_sizes": [1500, 4450, 4500],
          "df_bit_variations": [true, false]
        },
        "performance_testing": {
          "enabled": false,
          "max_pps": 1000,
          "duration": 30
        },
        "debug_features": {
          "packet_tracing": true,
          "interface_stats": true,
          "detailed_logging": true
        }
      }
    }
  }
}